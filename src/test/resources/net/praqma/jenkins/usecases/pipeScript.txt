node {
    git branch: 'arm-none-eabi-gcc_4.8.4_hello_world', url: 'https://github.com/Praqma/memory-map-examples'
    sh 'ls -al && pwd'

   def workspace = pwd()
   sh 'echo ${workspace}'
   
    sh '''
export BN=arm-none-eabi-gcc_4.8.4_hello_world
: ${BN:?"ERROR: run.sh requires env. var. BN to be set and not empty. It should be the example branch name checked out to run the example."}
DKRIMG=$BN:latest
[ "$(docker images | grep -c $BN)" -eq "0" ] && docker build --rm -f Dockerfile -t $DKRIMG .
docker run -v ${workspace}:/data $DKRIMG ls -al /data
'''

    sh 'export BN=arm-none-eabi-gcc_4.8.4_hello_world && sh ./run.sh'
}
